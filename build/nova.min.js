function ITER$0(n,e){if(n){if(Array.isArray(n))return e?n.slice():n;var r,o;if(S_MARK$0&&S_MARK$0(n),"object"==typeof n&&"function"==typeof(e=n[S_ITER$0])?(r=e.call(n),o=[]):n+""=="[object Generator]"&&(r=n,o=[]),S_MARK$0&&S_MARK$0(void 0),o){for(;e=r.next(),e.done!==!0;)o.push(e.value);return o}}throw new Error(n+" is not iterable")}function GET_ITER$0(n){if(n){if(Array.isArray(n))return 0;var e;if(S_MARK$0&&S_MARK$0(n),"object"==typeof n&&"function"==typeof(e=n[S_ITER$0]))return S_MARK$0&&S_MARK$0(void 0),e.call(n);if(S_MARK$0&&S_MARK$0(void 0),n+""=="[object Generator]")return n}throw new Error(n+" is not iterable")}var S_ITER$0="undefined"!=typeof Symbol&&Symbol&&Symbol.iterator||"@@iterator",S_MARK$0="undefined"!=typeof Symbol&&Symbol&&Symbol.__setObjectSetter__,nova={shared:{higherOrder:{},math:{},pipe:{}},components:{shapes:{},bodies:{},appearances:{},misc:{}},core:{engine:{},update:{},render:{},state:{}},utils:{input:{},assets:{},misc:{}}};!function(){var n=nova.shared.higherOrder,e=function(n){return n};n.id=e;var r=function(n){return function(e){return n}};n.constant=r;var o=function(n,e){return function(r){return n(e(r))}};n.compose=o;var t=function(n){return n.reduce(o,e)};n.chain=t;var a=function(n,e){return function(r){var o=Array.prototype.slice,t=o.call(arguments,1);return n.apply(null,[e.apply(null,[r].concat(ITER$0(t)))].concat(ITER$0(t)))}};n.composeP1=a;var i=function(n){return n.reduce(a,e)};n.chainP1=i}(),function(){var n=nova.shared.math,e=6.283185307179586;n.TAU=e;var r=e/2;n.PI=r;var o=function(n){return n/e*360};n.degrees=o;var t=function(n){return n/360*e};n.radians=t;var a=function(){var n=Math.floor(i(0,256)),e=Math.floor(i(0,256)),r=Math.floor(i(0,256));return"rgb("+n+", "+e+", "+r+")"};n.randomRGB=a;var i=function(n,e){return Math.random()*(e-n)+n};n.randomBetween=i;var u=function(n){return n[Math.floor(Math.random()*n.length)]};n.choose=u;var v=function(n,e){return Math.floor(n/e)*e};n.snap=v;var s=function(n,e,r){return n<e?e:n>r?r:n};n.clamp=s;var c=Object.freeze({GT:1,EQ:0,LT:-1});n.ORD=c;var d=function(n,e){return n>e?c.GT:n<e?c.LT:c.EQ};n.compare=d;var l=function(n){for(var e=[],r=0,o=n.length;r<o;r+=1)for(var t=n[r],a=r+1;a<o;a+=1){var i=n[a];e.push([t,i])}return e};n.combinations=l;var f=function(n,e){for(var r=[],o=0,t=n.length;o<t;o+=1)for(var a=n[o],i=0,u=e.length;i<u;i+=1){var v=e[i];r.push([a,v])}return r};n.combinationsBetween=f;var p=function(){var n=arguments[0];void 0===n&&(n=0);var e=arguments[1];return void 0===e&&(e=0),{x:n,y:e}};p.add=function(n,e){var r=n.x,n=n.y,o=e.x,e=e.y;return p(r+o,n+e)},p.sub=function(n,e){var r=n.x,n=n.y,o=e.x,e=e.y;return p(r-o,n-e)},p.mul=function(n,e){var r=n.x,n=n.y;return p(r*e,n*e)},p.div=function(n,e){var r=n.x,n=n.y;return p(r/e,n/e)},p.negate=function(n){var e=n.x,n=n.y;return p(-e,-n)},p.magnitude=function(n){var e=n.x,n=n.y;return Math.sqrt(e*e+n*n)},p.squareMagnitude=function(n){var e=n.x,n=n.y;return e*e+n*n},p.normal=function(n){return p.div(n,p.magnitude(n))},p.area=function(n){var e=n.x,n=n.y;return e*n},p.dot=function(n,e){var r=n.x,n=n.y,o=e.x,e=e.y;return r*o+n*e},p.rotate=function(n,e){var r=n.x,n=n.y,o=Math.cos(e),t=Math.sin(e);return p(r*o-n*t,r*t+n*o)},p.clone=function(n){var e=n.x,n=n.y;return p(e,n)},p.polar=function(n,e){return p(Math.cos(n)*e,Math.sin(n)*e)},p.ZERO=p(0,0),n.V=p}(),function(){var n=nova.shared.pipe,e=function(n){setTimeout(n,0)},r=function(){var n={};return n.listeners=[],n.queue=[],n.open=!0,n.open=function(){return r.open(n)},n.close=function(){return r.close(n)},n.read=function(e){return r.read(e,n)},n.write=function(e){return r.write(e,n)},n.flush=function(){return r.flush(n)},n.drain=function(e){return r.drain(n,e)},n.map=function(e){return r.map(e,n)},n.filter=function(e){return r.filter(e,n)},n.flatten=function(){return r.flatten(n)},n.flatMap=function(e){return r.flatMap(e,n)},n.foldp=function(e,o){return r.foldp(e,o,n)},n};r.open=function(n){return n.open=!0,n},r.close=function(n){return n.open=!1,n},r.read=function(n,e){return e.listeners.push(n),e},r.write=function(n,e){return e.queue.push(n),r.flush(e),e},r.flush=function(n){var e,r,o,t,a,i,u,v;if(n.open){t=n.queue,e=GET_ITER$0(t),o=0===e,r=o?t.length:void 0;for(var s;o?e<r:!(r=e.next()).done;){s=o?t[e++]:r.value,v=n.listeners,a=GET_ITER$0(v),u=0===a,i=u?v.length:void 0;for(var c;u?a<i:!(i=a.next()).done;)(c=u?v[a++]:i.value)(s);a=i=u=v=void 0}e=r=o=t=void 0,n.queue.length=0}return n},r.drain=function(n,e){return r.read(function(n){return r.write(n,e)},n),e},r.map=function(n,e){var o=r();return r.read(function(e){return r.write(n(e),o)},e),o},r.filter=function(n,e){var o=r();return r.read(function(e){return n(e)?r.write(e,o):void 0},e),o},r.flatten=function(n){var e=r();return r.read(function(n){return r.drain(n,e)},n),e},r.flatMap=function(n,e){return r.flatten(r.map(n,e))},r.foldp=function(n,e,o){var t=r(),a=e;return r.read(function(e){a=n(a,e),r.write(a,t)},t),t},r.fromArray=function(n){var o=r();return e(function(){var e,r,t;e=GET_ITER$0(n),t=0===e,r=t?n.length:void 0;for(var a;t?e<r:!(r=e.next()).done;)a=t?n[e++]:r.value,o.write(a);e=r=t=void 0}),o},r.interval=function(n){var e=r(),o=0;return setInterval(function(){r.write(o,e),o+=1},n),e},r.timeout=function(n){var e=r();return setTimeout(function(){r.write(0,e)},n),e},n.P=r}(),function(){var n=nova.components.shapes,e=nova.shared.math.V,r=Object.freeze({BOX:Symbol("Box"),CIRCLE:Symbol("Circle"),INFINITE:Symbol("Infinite"),REPEATING:Symbol("Repeating")});n.SHAPES=r;var o=function(n,o,t,a){return function(){var i=arguments[0];void 0===i&&(i={}),i.shape=r.BOX,i.pos=e(n,o),i.size=e(t,a)}};n.Box=o;var t=function(n,o,t){return function(){var a=arguments[0];return void 0===a&&(a={}),a.shape=r.CIRCLE,a.pos=e(n,o),a.radius=t,a}};n.Circle=t;var a=function(){var n=arguments[0];return void 0===n&&(n={}),n.shape=r.INFINITE,n};n.Infinite=a;var i=function(n,o,t,a){return function(){var i=arguments[0];return void 0===i&&(i={}),i.shape=r.REPEATING,i.pos=e(n,o),i.size=e(t,a),i}};n.Repeating=i}(),function(){var n=nova.components.bodies,e=nova.shared.math.V,r=Object.freeze({DYNAMIC:Symbol("Dynamic"),IMMOVABLE:Symbol("Immovable"),MOVABLE:Symbol("Movable")});n.BODIES=r;var o=function(n){return n.body===r.DYNAMIC||n.body===r.MOVABLE};n.canMove=o;var t=function(n){return n.body===r.DYNAMIC||n.body===r.IMMOVABLE};n.canCollide=t;var a=function(){var n=arguments[0];void 0===n&&(n=1);var o=arguments[1];return void 0===o&&(o=0),function(){var t=arguments[0];return void 0===t&&(t={}),t.body=r.DYNAMIC,t.mass=n,t.restitution=o,t.vel=e.ZERO,t.acc=e.ZERO,t.lastAcc=e.ZERO,t}};n.Dynamic=a;var i=function(){var n=arguments[0];return void 0===n&&(n=0),function(){var e=arguments[0];void 0===e&&(e={}),e.body=r.IMMOVABLE,e.mass=1/0,e.restitution=n}};n.Immovable=i;var u=function(){var n=arguments[0];return void 0===n&&(n=1),function(){var o=arguments[0];return void 0===o&&(o={}),o.body=r.MOVABLE,o.mass=n,o.vel=e.ZERO,o.acc=e.ZERO,o.lastAcc=e.ZERO,o}};n.Movable=u}(),function(){var n=nova.components.appearances,e=(nova.shared.higherOrder.constant,nova.shared.math.V),r=Object.freeze({COLOR:Symbol("Color"),PICTURE:Symbol("Picture"),SPRITE:Symbol("Sprite")});n.APPEARANCES=r;var o=function(n){return void 0!==n.appearance};n.hasAppearance=o;var t=function(n){var e=arguments[1];void 0===e&&(e=0);var o=arguments[2];return void 0===o&&(o=0),function(){var t=arguments[0];return void 0===t&&(t={}),t.appearance=r.COLOR,t.color=n,t.depth=e,t.layer=o,t}};n.Color=t;var a=function(n){var e=arguments[1];void 0===e&&(e=0);var o=arguments[2];return void 0===o&&(o=0),function(){var t=arguments[0];return void 0===t&&(t={}),t.appearance=r.PICTURE,t.image=n,t.depth=e,t.layer=o,t}};n.Picture=a;var i=function(n,o){var t=arguments[2];void 0===t&&(t=0);var a=arguments[3];return void 0===a&&(a=0),function(){var i=arguments[0];return void 0===i&&(i={}),i.appearance=r.SPRITE,i.image=n,i.animation=o,i.depth=t,i.layer=a,i.clipPos=e(0,0),i.clipSize=e(n.width,n.height),i.setAnimation=function(n){return i.animation=n,i.frame%=i.animation.length,i.determineClipPos(),i},i.animate=function(n){return i.animation.length>0&&(i.frame+=n,i.frame%=i.animation.length,i.determineClipPos()),i},i.resetAnimation=function(){return i.animation.length>0&&(i.frame=0,i.determineClipPos()),i},i.determineClipPos=function(){var n=i.animation[Math.floor(i.frame)];i.clipPos.x=n[0],i.clipPos.y=n[1]},i.buildAnimation=function(){var n=arguments[0];void 0===n&&(n=0);var e=arguments[1];void 0===e&&(e=0);var r=arguments[2];void 0===r&&(r=0);var o=arguments[3];void 0===o&&(o=0);for(var t=[],a=Math.ceil((i.image.width+r)/(i.size.x+r)),u=n;u<e;u++)t.push([(i.size.x+r)*(u%a),(i.size.y+o)*Math.floor(u/a)]);return t},i}};n.Sprite=i}(),function(){var n=nova.components.misc,e=nova.shared.math.randomBetween,r=(o=nova.components.shapes).Box,o=o.Circle,t=function(){var n=arguments[0];void 0===n&&(n={}),n.isObservable=!0;var e={};n.on=function(r,o){return void 0===e[r]&&(e[r]=[]),e[r].push(o),n},n.trigger=function(r,o){var t,a,i,u;if(void 0!==e[r]){u=e[r],t=GET_ITER$0(u),i=0===t,a=i?u.length:void 0;for(var v;i?t<a:!(a=t.next()).done;)v=i?u[t++]:a.value,v.apply(null,ITER$0(o));t=a=i=u=void 0}return void 0!==n[r]&&n[r].apply(n,ITER$0(o)),n}};n.Observable=t;var a=function(n){return function(){var e=arguments[0];return void 0===e&&(e={}),e.name=n,e}};n.Name=a;var i=function(n,e,r,o){return function(){var o=arguments[0];return void 0===o&&(o={}),o.update=function(t){return e.pressed(n.left)&&(o.pos.x-=r*t),e.pressed(n.up)&&(o.pos.y-=r*t),e.pressed(n.right)&&(o.pos.x+=r*t),e.pressed(n.down)&&(o.pos.y+=r*t),o},o}};n.Fourway=i;var u=function(n,e,r){return i({left:37,up:38,right:39,down:40},n,e,r)};n.Arrows=u;var v=function(n,e,r){return i({left:65,up:87,right:68,down:83},n,e,r)};n.WASD=v;var s=function(n,o,t,a){var i=e(0,t-n),u=e(0,a-o);return r(i,u,n,o)};n.RandomBox=s;var c=function(n,r,t){var a=e(n,r-n),i=e(n,t-n);return o(a,i,n)};n.RandomCircle=c}(),function(){var n=nova.core.engine,e=function(n,e,r){var o={},t=null,a=function(n){var o=arguments[1];void 0===o&&(o=window.performance.now()),t=requestAnimationFrame(function(){var t=window.performance.now(),i=(t-o)/1e3,u=e(n,.5*i);r(u,1),a(u,t)})};return o.start=function(){a(n)},o.stop=function(){cancelAnimationFrame(t)},o};n.Engine=e;var r=function(n,e,r){var o=arguments[3];void 0===o&&(o=1/60);var t=arguments[4];void 0===t&&(t=1/15);var a={},i=null,u=function(n){var a=arguments[1];void 0===a&&(a=window.performance.now());var v=arguments[2];void 0===v&&(v=0),i=requestAnimationFrame(function(){for(var i=window.performance.now(),s=(i-a)/1e3,c=v+Math.min(s,t),d=n;c>=o;)c-=o,d=e(d,o);r(d,1-c/s),u(d,i,c)})};return a.start=function(){u(n)},a.stop=function(){cancelAnimationFrame(i)},a};n.CruiseControl=r}(),function(){var n=nova.core.state,e=nova.shared.math.V,r=function(n,r){var o=arguments[2];void 0===o&&(o=0);var t={};return t.pos=e(n,r),t.depth=o,t};n.Camera=r;var o=function(n,e){var r={};return r.camera=n,r.bounds=e,r.entities=[],r.clear=function(){var n,e,o,t;t=r.entities,n=GET_ITER$0(t),o=0===n,e=o?t.length:void 0;for(var a;o?n<e:!(e=n.next()).done;)a=o?t[n++]:e.value,a.isObservable&&a.trigger("remove");return n=e=o=t=void 0,r.entities=[],r},r.add=function(n){return r.entities.push(n),n.isObservable&&n.trigger("add"),r},r.solo=function(n){return r.clear(),r.add(n),r},r};n.State=o}(),function(){var n=nova.core.update,e=nova.components.shapes.SHAPES,r=(o=nova.components.bodies).BODIES,o=o.canMove,t=(i=nova.shared.math).V,a=i.combinations,i=i.combinationsBetween,u=function(n){var e=n.integrate,o=n.collisionPairs,t=n.collision,a=n.resolve,n=n.update;return function(i,u){var v,s,c,d,l=[];d=i.entities,v=GET_ITER$0(d),c=0===v,s=c?d.length:void 0;for(var f;c?v<s:!(s=v.next()).done;)f=c?d[v++]:s.value,f.body!==r.DYNAMIC&&f.body!==r.MOVABLE||e(f,u),f.body!==r.DYNAMIC&&f.body!==r.IMMOVABLE||l.push(f);v=s=c=d=void 0;var p=o(l),m=void 0,h=void 0;for(v=GET_ITER$0(p),c=0===v,s=c?p.length:void 0;c?v<s:!(s=v.next()).done;){m=(h=c?p[v++]:s.value)[0],h=h[1];var E=t(m,h);null!==E&&a(E,m,h)}v=s=c=void 0,m=void 0,h=void 0,c=i.entities,d=GET_ITER$0(c),s=0===d,v=s?c.length:void 0;for(var y;s?d<v:!(v=d.next()).done;)y=s?c[d++]:v.value,n(y,u);return d=v=s=c=void 0,i}};n.updater=u;var v=function(n,e){return n.pos=t.add(n.pos,t.mul(t.add(n.vel,t.mul(n.lastAcc,e/2)),e)),n.vel=t.add(n.vel,t.mul(t.add(n.lastAcc,n.acc),e/2)),n.lastAcc=t.clone(n.acc),n};n.verletIntegrator=v;var s=function(n){var e,o,t,u=[],v=[];e=GET_ITER$0(n),t=0===e,o=t?n.length:void 0;for(var s;t?e<o:!(o=e.next()).done;)s=t?n[e++]:o.value,s.body===r.DYNAMIC?u.push(s):s.body===r.IMMOVABLE&&v.push(s);e=o=t=void 0;var c=a(u),d=i(u,v),l=c.concat(d);return l};n.bruteforcePairs=s;var c=function(n,e,r,o){var a=arguments[4];void 0===a&&(a=1);var i={};i.pos=t(n,e),i.size=t(r,o),i.trees=[],i.movableBodies=[],i.immovableBodies=[];var u=10,v=10,s=function(n){var e,r,o,t,a=(u=(v=n).pos).x1,u=u.y1,v=(n=v.size).x,n=n.y;t=i.trees,e=GET_ITER$0(t),o=0===e,r=o?t.length:void 0;for(var s;o?e<r:!(r=e.next()).done;){s=o?t[e++]:r.value;var c=(d=s.pos).x2,d=d.y2,l=(f=s.size).x,f=f.y;if(a>c&&a+v<c+l&&u>d&&u+n<d+f)return s}return e=r=o=t=void 0,null},d=function(){var n,e,r,o=i.size.over(2),t=o.x,u=o.y,v=(s=i.pos.plus(o)).x,s=s.y,d=(l=i.pos).x,l=l.y,f=c(d,l,t,u,a+1),p=c(v,l,t,u,a+1),m=c(d,s,t,u,a+1),h=c(v,s,t,u,a+1);i.trees.push(f,p,m,h);var E=i.bodies;i.bodies=[],n=GET_ITER$0(E),r=0===n,e=r?E.length:void 0;for(var y;r?n<e:!(e=n.next()).done;)y=r?E[n++]:e.value,i.add(y);n=e=r=void 0;var b=i.immovableBodies;i.immovableBodies=[],n=GET_ITER$0(b),r=0===n,e=r?b.length:void 0;for(var x;r?n<e:!(e=n.next()).done;)x=r?b[n++]:e.value,i.add(x);return n=e=r=void 0,i};return i.add=function(n){var e=s(n);return null!==e?e.add(n):(n.immovable?i.immovableBodies.push(n):i.movableBodies.push(n),i.movableBodies.length+i.immovableBodies.length>u&&a<v&&d()),i},i.pairs=function(n){var e,r,o,t,a=arguments[1];void 0===a&&(a=[]),a.push.apply(a,ITER$0(i.movableBodies)),n.immovable||a.push.apply(a,ITER$0(i.immovableBodies));var u=s(n);if(null!==u)u.pairs(n,a);else{t=i.trees,e=GET_ITER$0(t),o=0===e,r=o?t.length:void 0;for(var v;o?e<r:!(r=e.next()).done;)v=o?t[e++]:r.value,v.pairs(n,a);e=r=o=t=void 0}return i},i},d=function(n){var e,r,o,t=1/0,a=1/0,i=-(1/0),u=-(1/0),v=1/0,s=1/0,d=-(1/0),l=-(1/0);e=GET_ITER$0(n),o=0===e,r=o?n.length:void 0;for(var f;o?e<r:!(r=e.next()).done;)f=o?n[e++]:r.value,f.pos.x<t?(a=t,t=f.pos.x):f.pos.x<a&&(a=f.pos.x),f.pos.x+f.size.x>i?(u=i,i=f.pos.x+f.size.x):f.pos.x+f.size.x>u&&(u=f.pos.x+f.size.x),f.pos.y<v?(s=v,v=f.pos.y):f.pos.y<s&&(s=f.pos.y),f.pos.y+f.size.y>d?(l=d,d=f.pos.y+f.size.y):f.pos.y+f.size.y>l&&(l=f.pos.y+f.size.y);e=r=o=void 0;var p=c(a,s,u-a,l-s);e=GET_ITER$0(n),o=0===e,r=o?n.length:void 0;for(var m;o?e<r:!(r=e.next()).done;)m=o?n[e++]:r.value,p.add(m);return e=r=o=void 0,p.pairs()};n.quadtreePairs=d;var l=function(n,r){if(n.shape===e.BOX&&r.shape===e.BOX){if(n.pos.x<r.pos.x+r.size.x&&n.pos.x+n.size.x>r.pos.x&&n.pos.y<r.pos.y+r.size.y&&n.pos.y+n.size.y>r.pos.y){var o=t.sub(t.add(n.pos,n.size),r.pos),a=t.sub(n.pos,t.add(r.pos,r.size)),i=Math.abs(o.x)<Math.abs(a.x)?o.x:a.x,u=Math.abs(o.y)<Math.abs(a.y)?o.y:a.y,v=Math.abs(i)>=Math.abs(u)?t(i,0):t(0,u);return v}return null}if(n.shape===e.CIRCLE&&r.shape===e.CIRCLE){var s=t.sub(r.pos,n.pos),c=t.squareMagnitude(s),d=n.radius+r.radius;if(c<d*d){var l=Math.sqrt(c),f=t.mul(s,(d-l)/l);return f}return null}};n.getCollision=l;var f=Object.freeze({RESOLVE:Symbol("Resolve"),IGNORE:Symbol("Ignore")});n.COLLISION_RESPONSE=f;var p=function(n,e){return function(r,o,a){var i=void 0!==o.resolve?o.resolve(r,o):f.RESOLVE,u=void 0!==a.resolve?a.resolve(r,a):f.RESOLVE;if(i===f.RESOLVE&&u===f.RESOLVE){var v=t.magnitude(r),s=t.div(r,v),c=t.dot(t.sub(a.vel,o.vel),s);if(c<=0){var d=1/o.mass,l=1/a.mass,p=-(1+Math.min(o.restitution,a.restitution))*c/(d+l),m=t.mul(s,p);o.vel=t.sub(o.vel,t.mul(m,d)),a.vel=t.add(a.vel,t.mul(m,l));var h=t.mul(s,Math.max(v-e,0)/(d+l)*n);o.pos=t.sub(o.pos,t.mul(h,d)),a.pos=t.add(a.pos,t.mul(h,l))}}}};n.impulseResolver=p;var m=function(n,e,r){e.pos=t.sub(e.pos,n),e.vel.x*n.x>0&&(e.vel.x=r.vel.x),e.vel.y*n.y>0&&(e.vel.y=r.vel.y)};n.positionalResolver=m;var h=function(n,e){return void 0!==n.update?n.update(e):n};n.updateChild=h;var E=u({integrate:v,collisionPairs:s,collision:l,resolve:p(.7,0),update:h});n.defaultUpdate=E;var y=function(n){var e=function(e,r){var o=t.sub(e.pos,r.pos),a=t.magnitude(o),i=e.mass,u=r.mass,v=n*i*u/(a*a);return t.mul(t.normal(o),v)};return function(n,r){var i,u,v,s,c=n.entities.filter(o);i=GET_ITER$0(c),v=0===i,u=v?c.length:void 0;for(var d;v?i<u:!(u=i.next()).done;)d=v?c[i++]:u.value,d.acc=t.ZERO;i=u=v=void 0;var l=void 0,f=void 0;for(s=a(c),i=GET_ITER$0(s),v=0===i,u=v?s.length:void 0;v?i<u:!(u=i.next()).done;){l=(f=v?s[i++]:u.value)[0],f=f[1];var p=e(l,f),m=t.negate(p);l.acc=t.add(l.acc,t.div(m,l.mass)),f.acc=t.add(f.acc,t.div(p,f.mass))}return i=u=v=s=void 0,l=void 0,f=void 0,n}};n.applyGravity=y}(),function(){var n=nova.core.render,e=nova.components.shapes.SHAPES,r=(o=nova.components.appearances).APPEARANCES,o=o.hasAppearance,t=nova.shared.math.V,a=function(n,r,o){if(o.shape===e.INFINITE)return!0;if(o.shape===e.REPEATING)return!0;if(o.shape===e.BOX){var t=(a=o.pos).x,a=a.y,i=(u=o.size).x,u=u.y,v=(s=r.pos).x,s=s.y,c=(d=[n.canvas.width,n.canvas.height])[0],d=d[1];return t+i-v>0&&a+u-s>0&&t-v<c&&a-s<d}if(o.shape===e.CIRCLE){var l=(f=o.pos).x,f=f.y,p=o.radius,m=(h=r.pos).x,h=h.y,E=(y=[n.canvas.width,n.canvas.height])[0],y=y[1];return l+p-m>0&&f+p-h>0&&l-p-m<E&&f-p-h<y}return!1},i=function(n,o,a){if(a.appearance===r.COLOR){if(a.shape===e.BOX){var i=(u=t.sub(a.pos,o.pos)).x,u=u.y,v=(s=a.size).x,s=s.y;n.fillStyle=a.color,n.fillRect(i,u,v,s)}else if(a.shape===e.CIRCLE){var c=(d=t.sub(a.pos,o.pos)).x,d=d.y,l=a.radius;n.fillStyle=a.color,n.beginPath(),n.arc(c,d,l,0,2*Math.PI),n.fill()}else if(a.shape===e.INFINITE){var f=(p=[n.canvas.width,n.canvas.height])[0],p=p[1];n.fillStyle=a.color,n.fillRect(0,0,f,p)}}else if(a.appearance===r.PICTURE){if(a.shape===e.BOX){var m=(h=t.sub(a.pos,o.pos)).x,h=h.y;n.drawImage(a.image,m,h,a.size.x,a.size.y)}else if(a.shape===e.REPEATING)var E=((E=t.sub(a.pos,o.pos)).x,E.y),y=((y=a.size).x,y.y),b=((b=[n.canvas.width,n.canvas.height])[0],b[1])}else if(a.appearance===r.SPRITE&&a.shape===e.BOX){var x=(g=t.sub(a.pos,o.pos)).x,g=g.y;n.drawImage(a.image,a.clipPos.x,a.clipPos.y,a.clipSize.x,a.clipSize.y,x,g,a.size.x,a.size.y)}},u=function(n){var e=n.getContext("2d");return function(r,t){var u,v,s,c,d=[];c=r.entities,u=GET_ITER$0(c),s=0===u,v=s?c.length:void 0;for(var l;s?u<v:!(v=u.next()).done;)l=s?c[u++]:v.value,o(l)&&a(e,r.camera,l)&&d.push(l);u=v=s=c=void 0;var f=d.sort(function(n,e){return e.depth-n.depth||e.layer-n.layer});e.clearRect(0,0,n.width,n.height),u=GET_ITER$0(f),s=0===u,v=s?f.length:void 0;for(var p;s?u<v:!(v=u.next()).done;)p=s?f[u++]:v.value,i(e,r.camera,p);u=v=s=void 0}};n.renderer=u}(),function(){var n=nova.utils.input,e=nova.shared.math.V,r=function(n){var e=n.getBoundingClientRect(),r=document.body,o=document.documentElement,t=window.pageYOffset||o.scrollTop||r.scrollTop,a=window.pageXOffset||o.scrollLeft||r.scrollLeft,i=o.clientTop||r.clientTop||0,u=o.clientLeft||r.clientLeft||0,v=e.top+t-i,s=e.left+a-u;return{x:Math.round(s),y:Math.round(v)}},o=Object.freeze({CLICKED:Symbol("Clicked"),CANCELLED:Symbol("Cancelled"),UNCLICKED:Symbol("Unclicked")}),t=function(n){var t={},a=o.UNCLICKED;return t.pos=e(0,0),t.clicked=function(){return a===o.CLICKED},t.cancel=function(){return a===o.CLICKED&&(a=o.CANCELLED),t},n.addEventListener("mousedown",function(){a!==o.CANCELLED&&(a=o.CLICKED)},!1),n.addEventListener("mouseup",function(){a=o.UNCLICKED},!1),n.addEventListener("mousemove",function(e){var o=r(n);t.pos.x=e.clientX-o.x,t.pos.y=e.clientY-o.y},!1),t};n.Mouse=t;var a=Object.freeze({LEFT:37,UP:38,RIGHT:39,DOWN:40});n.KEYS=a;var i=Object.freeze({PRESSED:Symbol("Pressed"),CANCELLED:Symbol("Cancelled"),UNPRESSED:Symbol("Unpressed")}),u=function(){var n={},e={};return window.addEventListener("keydown",function(n){e[n.keyCode]!==i.CANCELLED&&(e[n.keyCode]=i.PRESSED)},!1),window.addEventListener("keyup",function(n){e[n.keyCode]=i.UNPRESSED},!1),n.pressed=function(n){return e[n]===i.PRESSED},n.cancel=function(r){return e[r]===i.PRESSED&&(e[r]=i.CANCELLED),n},n};n.Keyboard=u}(),function(){var n=nova.utils.assets,e=function(n){return new Promise(function(e,r){var o=new Image;o.onload=function(){e(o)},o.src=n})};n.loadImage=e;var r=function(n){return new Promise(function(e,r){var o=new Audio;o.oncanplay=function(){e(o)},o.src=n})};n.loadAudioMedia=r;var o=function(){return void 0===o.singleton&&(o.singleton=void 0!==window.AudioContext?new window.AudioContext:void 0!==window.WebkitAudioContext?new window.WebkitAudioContext:null),o.singleton},t=function(n){if(null!==o())return new Promise(function(e,r){var t=new XMLHttpRequest;t.open("GET",n,!0),t.responseType="arraybuffer",t.onload=function(){o().decodeAudioData(t.response,function(o){return o?void e(o):void r(new Error("Error decoding file data: "+n))},function(n){r(n)})},t.onerror=function(){r("Audio failed to load.")},t.send()})};n.loadAudioBuffer=t;var a=function(n){return new Promise(function(e,r){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&200===o.status&&e(JSON.parse(o.responseText))},o.open("GET",n),o.send()})};n.loadJSON=a;var i=function(n){return new Promise(function(e,r){var o=document.createElement("script");o.onload=o.onreadystatechange=function(){o.readyState&&"compconste"!=o.readyState||e(o)},o.src=n,document.getElementsByTagName("head")[0].appendChild(o)})};n.loadScript=i;var u={jpg:e,png:e,bmp:e,mp3:r,ogg:r,wav:r,json:a,js:i},v=function(n){var e=n.match(/(?:\.([^.]+))?$/)[1],r=u[e];return void 0!==r?r(n):Promise.reject(Error('Unknown extension "'+e+'".'))};n.load=v;var s=function(n){var e,r,o,t,a=[];t=Object.keys(n),e=GET_ITER$0(t),o=0===e,r=o?t.length:void 0;for(var i;o?e<r:!(r=e.next()).done;)i=o?t[e++]:r.value,a.push([i,n[i]]);return e=r=o=t=void 0,a},c=function(n){var e={};return Promise.all(s(n).map(function(n){var r=n[0],n=n[1];return v(n).then(function(n){e[r]=n})})).then(function(){return e})};n.loadAll=c}(),function(){var n=nova.utils.misc,e=function(n){var e=arguments[1];void 0===e&&(e=0);var r={};return r.progress=function(r,o){for(e+=r;e>=n;)e-=n,o()},r};n.interval=e;var r=function(n,e){var r=localStorage.getItem(n);return null!==r?r:e};n.loadData=r;var o=function(n,e){return localStorage.setItem(n,e)};n.saveData=o}();